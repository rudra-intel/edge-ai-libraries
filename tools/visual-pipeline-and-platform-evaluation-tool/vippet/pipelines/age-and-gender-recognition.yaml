name: Age & Gender Recognition
definition: >
  The Retail Pipeline using face-detection-retail-0004 for object detection and age-gender-recognition-retail-0013 for age and gender prediction is designed for retail analytics applications.
  It detects faces, predicts age groups and gender, making it suitable for customer demographics analysis and other retail use cases.
tags:
  - Retail
thumbnail: images/age-and-gender-recognition.png
variants:
  - name: CPU
    pipeline_description: >-
      filesrc location=/videos/input/age_prediction.mp4 !
      decodebin3 !
      gvadetect
        batch-size=1
        model-instance-id=facemodel-cpu
        model=/models/output/omz/face-detection-retail-0004/FP16/face-detection-retail-0004.xml
        model-proc=/models/output/omz/face-detection-retail-0004/face-detection-retail-0004.json
        inference-interval=3
        scale-method=fast
        inference-region=full-frame
        threshold=0.5
        device=CPU
        pre-process-backend=opencv
        ie-config=CPU_THROUGHPUT_STREAMS=2
        nireq=2 !
      queue !
      gvatrack tracking-type=zero-term-imageless !
      queue !
      gvaclassify
        batch-size=1
        model-instance-id=age_classifier-cpu
        model=/models/output/omz/age-gender-recognition-retail-0013/FP16/age-gender-recognition-retail-0013.xml
        model-proc=/models/output/omz/age-gender-recognition-retail-0013/age-gender-recognition-retail-0013.json
        device=CPU
        pre-process-backend=opencv
        inference-region=roi-list
        object-class=face
        reclassify-interval=1 !
      queue !
      gvafpscounter starting-frame=100 !
      gvawatermark !
      gvametaconvert !
      queue !
      gvametapublish file-format=json-lines file-path=/dev/null !
      fakesink name=default_output_sink sync=false async=false
  - name: GPU
    pipeline_description: >-
      filesrc location=/videos/input/age_prediction.mp4 !
      decodebin3 !
      gvadetect
        batch-size=1
        model-instance-id=facemodel-gpu
        model=/models/output/omz/face-detection-retail-0004/FP16/face-detection-retail-0004.xml
        model-proc=/models/output/omz/face-detection-retail-0004/face-detection-retail-0004.json
        inference-interval=3
        scale-method=fast
        inference-region=full-frame
        threshold=0.5
        device=GPU
        pre-process-backend=va-surface-sharing
        ie-config=GPU_THROUGHPUT_STREAMS=2
        nireq=2 !
      queue !
      gvatrack tracking-type=zero-term-imageless !
      queue !
      gvaclassify
        batch-size=1
        model-instance-id=age_classifier-gpu
        model=/models/output/omz/age-gender-recognition-retail-0013/FP16/age-gender-recognition-retail-0013.xml
        model-proc=/models/output/omz/age-gender-recognition-retail-0013/age-gender-recognition-retail-0013.json
        device=GPU
        pre-process-backend=va-surface-sharing
        inference-region=roi-list
        object-class=face
        reclassify-interval=1 !
      queue !
      gvafpscounter starting-frame=100 !
      gvawatermark !
      gvametaconvert !
      queue !
      gvametapublish file-format=json-lines file-path=/dev/null !
      fakesink name=default_output_sink sync=false async=false
  - name: NPU
    pipeline_description: >-
      filesrc location=/videos/input/age_prediction.mp4 !
      decodebin3 !
      gvadetect
        batch-size=1
        model-instance-id=facemodel-npu
        model=/models/output/omz/face-detection-retail-0004/FP16/face-detection-retail-0004.xml
        model-proc=/models/output/omz/face-detection-retail-0004/face-detection-retail-0004.json
        inference-interval=3
        scale-method=fast
        inference-region=full-frame
        threshold=0.5
        device=NPU
        pre-process-backend=va
        nireq=4 !
      queue !
      gvatrack tracking-type=zero-term-imageless !
      queue !
      gvaclassify
        batch-size=1
        model-instance-id=age_classifier-npu
        model=/models/output/omz/age-gender-recognition-retail-0013/FP16/age-gender-recognition-retail-0013.xml
        model-proc=/models/output/omz/age-gender-recognition-retail-0013/age-gender-recognition-retail-0013.json
        device=NPU
        pre-process-backend=va
        inference-region=roi-list
        object-class=face
        reclassify-interval=1 !
      queue !
      gvafpscounter starting-frame=100 !
      gvawatermark !
      gvametaconvert !
      queue !
      gvametapublish file-format=json-lines file-path=/dev/null !
      fakesink name=default_output_sink sync=false async=false
  - name: GPU_NPU
    pipeline_description: >-
      filesrc location=/videos/input/age_prediction.mp4 !
      decodebin3 !
      gvadetect
        batch-size=1
        model-instance-id=facemodel-gpu-npu
        model=/models/output/omz/face-detection-retail-0004/FP16/face-detection-retail-0004.xml
        model-proc=/models/output/omz/face-detection-retail-0004/face-detection-retail-0004.json
        inference-interval=3
        scale-method=fast
        inference-region=full-frame
        threshold=0.5
        device=GPU
        pre-process-backend=va-surface-sharing
        ie-config=GPU_THROUGHPUT_STREAMS=2
        nireq=2 !
      queue !
      gvatrack tracking-type=zero-term-imageless !
      queue !
      gvaclassify
        batch-size=1
        model-instance-id=age_classifier-gpu-npu
        model=/models/output/omz/age-gender-recognition-retail-0013/FP16/age-gender-recognition-retail-0013.xml
        model-proc=/models/output/omz/age-gender-recognition-retail-0013/age-gender-recognition-retail-0013.json
        device=NPU
        pre-process-backend=va
        inference-region=roi-list
        object-class=face
        reclassify-interval=1 !
      queue !
      gvafpscounter starting-frame=100 !
      gvawatermark !
      gvametaconvert !
      queue !
      gvametapublish file-format=json-lines file-path=/dev/null !
      fakesink name=default_output_sink sync=false async=false
